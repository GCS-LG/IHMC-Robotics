clc, clear all
k=39.478;
b=6.283;
kp=300;kd=20;
Km=-[kp kd];
A=[0 1;-(k+k*kp) -(b+k*kd)];
P=[0.559997897612298   0.036790339997008
   0.036790339997008   0.002424912189936];
x0=[-1.724*10^-3;0.0389];
X=zeros(2,1000);
V(:,1)=1/2*x0'*P*x0;
X(:,1)=x0;
dt=10^-5;
x=x0;
for i=1:10000
    x=x+A*x*dt;
    V(i+1,1)=1/2*x'*P*x;
    X(:,i+1)=x;
    dF(:,i+1)=Km*A*x;
end
figure(4)
plot(dt*(1:10001),V)
figure(5)
plot(dt*(1:10001),dF)